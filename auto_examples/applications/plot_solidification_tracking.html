

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Track solidification of a metallic alloy &#8212; skimage 0.21.0rc1.dev0 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Vibur" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyterlite_sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/theme_overrides.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/jupyterlite_sphinx.js"></script>
    <script src="../../_static/design-tabs.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'auto_examples/applications/plot_solidification_tracking';</script>
    <script>
        DOCUMENTATION_OPTIONS.theme_switcher_json_url = 'https://scikit-image.org/docs/dev/_static/version_switcher.json';
        DOCUMENTATION_OPTIONS.theme_switcher_version_match = 'dev';
        </script>
    <link rel="icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Measure fluorescence intensity at the nuclear envelope" href="plot_fluorescence_nuclear_envelope.html" />
    <link rel="prev" title="Thresholding" href="plot_thresholding_guide.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="scikit-image's logo, showing a snake's head overlayed with green and orange"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="scikit-image's logo, showing a snake's head overlayed with green and orange"/>`);</script>
  
  
    <p class="title logo__title">scikit-image</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release_notes/index.html">
                        Release notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../development/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      dev  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
      
        <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-image/scikit-image" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/scikit-image/" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
</ul></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        User guide
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../release_notes/index.html">
                        Release notes
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../development/index.html">
                        Development
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../about/index.html">
                        About
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <div class="version-switcher__container dropdown">
    <button type="button" class="version-switcher__button btn btn-sm navbar-btn dropdown-toggle" data-bs-toggle="dropdown">
      dev  <!-- this text may get changed later by javascript -->
      <span class="caret"></span>
    </button>
    <div class="version-switcher__menu dropdown-menu list-group-flush py-0">
    <!-- dropdown will be populated by javascript on page load -->
    </div>
  </div>
`);
</script></div>
        
          <div class="navbar-item"><ul class="navbar-icon-links navbar-nav"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/scikit-image/scikit-image" title="GitHub" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-brands fa-square-github"></i></span>
            <label class="sr-only">GitHub</label></a>
        </li>
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://pypi.org/project/scikit-image/" title="PyPI" class="nav-link" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><span><i class="fa-solid fa-box"></i></span>
            <label class="sr-only">PyPI</label></a>
        </li>
</ul></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../data/index.html">Data</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_3d.html">Datasets with 3 or more spatial dimensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_scientific.html">Scientific images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_general.html">General-purpose images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/plot_specific.html">Specific images</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numpy_operations/index.html">Operations on NumPy arrays</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_camera_numpy.html">Using simple NumPy operations for manipulating images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_structuring_elements.html">Generate footprints (structuring elements)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_view_as_blocks.html">Block views on images/arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numpy_operations/plot_footprint_decompositions.html">Decompose flat footprints (structuring elements)</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../color_exposure/index.html">Manipulating exposure and color channels</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_rgb_to_gray.html">RGB to grayscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_rgb_to_hsv.html">RGB to HSV</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_histogram_matching.html">Histogram matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_adapt_rgb.html">Adapting gray-scale filters to RGB images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_ihc_color_separation.html">Separate colors in immunohistochemical staining</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_regional_maxima.html">Filtering regional maxima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_log_gamma.html">Gamma and log contrast adjustment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_equalize.html">Histogram Equalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_tinting_grayscale_images.html">Tinting gray-scale images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_local_equalize.html">Local Histogram Equalization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../color_exposure/plot_adapt_hist_eq_3d.html">3D adaptive histogram equalization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../edges/index.html">Edges and lines</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_contours.html">Contour finding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_convex_hull.html">Convex Hull</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_canny.html">Canny edge detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_marching_cubes.html">Marching Cubes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_ridge_filter.html">Ridge operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_active_contours.html">Active Contour Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_shapes.html">Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_random_shapes.html">Random Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_polygon.html">Approximate and subdivide polygons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_line_hough_transform.html">Straight line Hough transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_circular_elliptical_hough_transform.html">Circular and Elliptical Hough Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_skeleton.html">Skeletonize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../edges/plot_edge_filter.html">Edge operators</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../transform/index.html">Geometrical transformations and registration</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_swirl.html">Swirl</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_edge_modes.html">Interpolation: Edge Modes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_rescale.html">Rescale, resize, and downscale</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_pyramid.html">Build image pyramids</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_piecewise_affine.html">Piecewise Affine Transformation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_geometric.html">Using geometric transformations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_ssim.html">Structural similarity index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_transform_types.html">Types of homographies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_fundamental_matrix.html">Fundamental matrix estimation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_ransac.html">Robust line model estimation using RANSAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_radon_transform.html">Radon transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../transform/plot_matching.html">Robust matching using RANSAC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../registration/index.html">Image registration</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_register_translation.html">Image Registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_masked_register_translation.html">Masked Normalized Cross-Correlation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_opticalflow.html">Registration using optical flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_stitching.html">Assemble images with simple image stitching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../registration/plot_register_rotation.html">Using Polar and Log-Polar Transformations for Registration</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../filters/index.html">Filtering and restoration</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_tophat.html">Removing small objects in grayscale images with a top hat filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_hysteresis.html">Hysteresis thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_restoration.html">Image Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_window.html">Using window functions with images</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_unsharp_mask.html">Unsharp masking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_rank_mean.html">Mean filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_deconvolution.html">Image Deconvolution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_blur_effect.html">Estimate strength of blur</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_entropy.html">Entropy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_j_invariant.html">Calibrating Denoisers Using J-Invariance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_inpaint.html">Inpainting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_dog.html">Band-pass filtering by Difference of Gaussians</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_denoise.html">Denoising a picture</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_cycle_spinning.html">Shift-invariant wavelet denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_phase_unwrap.html">Phase Unwrapping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_nonlocal_means.html">Non-local means denoising for preserving textures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_attribute_operators.html">Attribute operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_denoise_wavelet.html">Wavelet denoising</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_butterworth.html">Butterworth Filters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filters/plot_j_invariant_tutorial.html">Full tutorial on calibrating Denoisers Using J-Invariance</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../features_detection/index.html">Detection of features and objects</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_daisy.html">Dense DAISY feature description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_hog.html">Histogram of Oriented Gradients</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_template.html">Template Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_holes_and_peaks.html">Filling holes and finding peaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_censure.html">CENSURE feature detector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_corner.html">Corner detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_multiblock_local_binary_pattern.html">Multi-Block Local Binary Pattern for texture classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_haar.html">Haar-like feature descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_blob.html">Blob Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_orb.html">ORB feature detector and binary descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_gabors_from_astronaut.html">Gabors / Primary Visual Cortex “Simple Cells” from an Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_fisher_vector.html">Fisher vector feature encoding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_brief.html">BRIEF binary descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_sift.html">SIFT feature detector and descriptor extractor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_glcm.html">GLCM Texture Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_shape_index.html">Shape Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_windowed_histogram.html">Sliding window histogram</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_gabor.html">Gabor filter banks for texture classification</a></li>
<li class="toctree-l2"><a class="reference internal" href="../features_detection/plot_local_binary_pattern.html">Local Binary Pattern for texture classification</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../segmentation/index.html">Segmentation of objects</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_boundary.html">Region Boundary based RAGs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_mean_color.html">RAG Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_ncut.html">Normalized Cut</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_compact_watershed.html">Find Regular Segments Using Compact Watershed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_thresholding.html">Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_draw.html">Drawing Region Adjacency Graphs (RAGs)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_chan_vese.html">Chan-Vese Segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_peak_local_max.html">Finding local maxima</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_niblack_sauvola.html">Niblack and Sauvola Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_multiotsu.html">Multi-Otsu Thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_mask_slic.html">Apply maskSLIC vs SLIC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_random_walker_segmentation.html">Random walker segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_expand_labels.html">Expand segmentation labels without overlap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_watershed.html">Watershed segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_label.html">Label image regions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_marked_watershed.html">Markers for watershed transform</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_segmentations.html">Comparison of segmentation and superpixel algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_join_segmentations.html">Find the intersection of two segmentations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag.html">Region Adjacency Graphs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_perimeters.html">Measure perimeters with different estimators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rag_merge.html">RAG Merging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_boundary_merge.html">Hierarchical Merging of Region Boundary RAGs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_extrema.html">Extrema</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_regionprops_table.html">Explore and visualize region properties with pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_hausdorff_distance.html">Hausdorff Distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_regionprops.html">Measure region properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_trainable_segmentation.html">Trainable segmentation using local features and random forests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_morphsnakes.html">Morphological Snakes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_floodfill.html">Flood Fill</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_euler_number.html">Euler number</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_metrics.html">Evaluating segmentation metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../segmentation/plot_rolling_ball.html">Use rolling-ball algorithm for estimating background intensity</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Longer examples and demonstrations</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="plot_text.html">Render text onto an image</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_face_detection.html">Face detection using a cascade classifier</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_interaction.html">Interact with 3D images (of kidney tissue)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_pixel_graphs.html">Use pixel graphs to find an object’s geodesic center</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_image_comparison.html">Visual image comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_morphology.html">Morphological Filtering</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_structure_tensor.html">Estimate anisotropy in a 3D microscopy image</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_coins_segmentation.html">Comparing edge-based and region-based segmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_colocalization_metrics.html">Colocalization metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_human_mitosis.html">Segment human cells (in mitosis)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_thresholding_guide.html">Thresholding</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Track solidification of a metallic alloy</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_fluorescence_nuclear_envelope.html">Measure fluorescence intensity at the nuclear envelope</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_haar_extraction_selection_classification.html">Face classification using Haar-like feature descriptor</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_3d_image_processing.html">Explore 3D images (of cells)</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_rank_filters.html">Rank filters</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../developers/index.html">Examples for developers</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../developers/plot_threshold_li.html">Li thresholding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../developers/plot_max_tree.html">Max-tree</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Longer examples and demonstrations</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Track solidification of a metallic alloy</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-applications-plot-solidification-tracking-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code or to run this example in your browser via JupyterLite or Binder</p>
</div>
<section class="sphx-glr-example-title" id="track-solidification-of-a-metallic-alloy">
<span id="sphx-glr-auto-examples-applications-plot-solidification-tracking-py"></span><h1>Track solidification of a metallic alloy<a class="headerlink" href="#track-solidification-of-a-metallic-alloy" title="Permalink to this heading">#</a></h1>
<p>In this example, we identify and track the solid-liquid (S-L) interface in a
nickel-based alloy undergoing solidification. Tracking the solidification over
time enables the calculatation of the solidification velocity. This is
important to characterize the solidified structure of the sample and will be
used to inform research into additive manufacturing of metals. The image
sequence was obtained by the Center for Advanced Non-Ferrous Structural Alloys
(CANFSA) using synchrotron x-radiography at the Advanced Photon Source (APS)
at Argonne National Laboratory (ANL). This analysis was first presented at
a conference <a class="footnote-reference brackets" href="#id2" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id2" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>Corvellec M. and Becker C. G. (2021, May 17-18)
“Quantifying solidification of metallic alloys with scikit-image”
[Conference presentation]. BIDS ImageXD 2021 (Image Analysis Across
Domains). Virtual participation.
<a class="reference external" href="https://www.youtube.com/watch?v=cB1HTgmWTd8">https://www.youtube.com/watch?v=cB1HTgmWTd8</a></p>
</aside>
</aside>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">plotly.io</span>

<span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">filters</span><span class="p">,</span> <span class="n">measure</span><span class="p">,</span> <span class="n">restoration</span>
<span class="kn">from</span> <span class="nn">skimage.data</span> <span class="kn">import</span> <span class="n">nickel_solidification</span>

<span class="n">image_sequence</span> <span class="o">=</span> <span class="n">nickel_solidification</span><span class="p">()</span>

<span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">x1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">330</span>

<span class="n">image_sequence</span> <span class="o">=</span> <span class="n">image_sequence</span><span class="p">[:,</span> <span class="n">y0</span><span class="p">:</span><span class="n">y1</span><span class="p">,</span> <span class="n">x0</span><span class="p">:</span><span class="n">x1</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;shape: </span><span class="si">{</span><span class="n">image_sequence</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The dataset is a 2D image stack with 11 frames (time points).
We visualize and analyze it in a workflow where the first image processing
steps are performed on the entire three-dimensional dataset (i.e., across
space and time),
such that the removal of localized, transient noise is favored as
opposed to that of physical features (e.g., bubbles, splatters, etc.), which
exist in roughly the same position from one frame to the next.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">image_sequence</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<section id="compute-image-deltas">
<h2>Compute image deltas<a class="headerlink" href="#compute-image-deltas" title="Permalink to this heading">#</a></h2>
<p>Let us first apply a Gaussian low-pass filter in order to smooth
the images and reduce noise.
Next, we compute the image deltas, i.e., the sequence of differences
between two consecutive frames. To do this, we subtract the image sequence
ending at the second-to-last frame from the image sequence starting
at the second frame.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">smoothed</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">gaussian</span><span class="p">(</span><span class="n">image_sequence</span><span class="p">)</span>
<span class="n">image_deltas</span> <span class="o">=</span> <span class="n">smoothed</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">smoothed</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">image_deltas</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clip-lowest-and-highest-intensities">
<h2>Clip lowest and highest intensities<a class="headerlink" href="#clip-lowest-and-highest-intensities" title="Permalink to this heading">#</a></h2>
<p>We now calculate the 5th and 95th percentile intensities of <code class="docutils literal notranslate"><span class="pre">image_deltas</span></code>:
We want to clip the intensities which lie below the 5th percentile
intensity and above the 95th percentile intensity, while also rescaling
the intensity values to [0, 1].</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p_low</span><span class="p">,</span> <span class="n">p_high</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.percentile.html#numpy.percentile" title="numpy.percentile" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">percentile</span></a><span class="p">(</span><span class="n">image_deltas</span><span class="p">,</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">])</span>
<span class="n">clipped</span> <span class="o">=</span> <span class="n">image_deltas</span> <span class="o">-</span> <span class="n">p_low</span>
<span class="n">clipped</span><span class="p">[</span><span class="n">clipped</span> <span class="o">&lt;</span> <span class="mf">0.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="n">clipped</span> <span class="o">=</span> <span class="n">clipped</span> <span class="o">/</span> <span class="n">p_high</span>
<span class="n">clipped</span><span class="p">[</span><span class="n">clipped</span> <span class="o">&gt;</span> <span class="mf">1.0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">clipped</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="invert-and-denoise">
<h2>Invert and denoise<a class="headerlink" href="#invert-and-denoise" title="Permalink to this heading">#</a></h2>
<p>We invert the <code class="docutils literal notranslate"><span class="pre">clipped</span></code> images so the regions of highest intensity
will include the region we are interested in tracking (i.e., the
S-L interface). Then, we apply a total variation denoising filter to reduce
noise beyond the interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">inverted</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">clipped</span>
<span class="n">denoised</span> <span class="o">=</span> <span class="n">restoration</span><span class="o">.</span><span class="n">denoise_tv_chambolle</span><span class="p">(</span><span class="n">inverted</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">denoised</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="binarize">
<h2>Binarize<a class="headerlink" href="#binarize" title="Permalink to this heading">#</a></h2>
<p>Our next step is to create binary images, splitting the images
into foreground and background: We want the S-L interface
to be the most prominent feature in the foreground of each binary image,
so that it can eventually be separated from the rest of the image.</p>
<p>We need
a threshold value <code class="docutils literal notranslate"><span class="pre">thresh_val</span></code> to create our binary images, <code class="docutils literal notranslate"><span class="pre">binarized</span></code>.
This can be set manually, but we shall use an automated minimum threshold
method from the <code class="docutils literal notranslate"><span class="pre">filters</span></code> submodule of scikit-image (there are other
methods that may work better for different applications).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">thresh_val</span> <span class="o">=</span> <span class="n">filters</span><span class="o">.</span><span class="n">threshold_minimum</span><span class="p">(</span><span class="n">denoised</span><span class="p">)</span>
<span class="n">binarized</span> <span class="o">=</span> <span class="n">denoised</span> <span class="o">&gt;</span> <span class="n">thresh_val</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">binarized</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="select-largest-region">
<h2>Select largest region<a class="headerlink" href="#select-largest-region" title="Permalink to this heading">#</a></h2>
<p>In our binary images, the S-L interface appears as the largest region of
connected pixels. For this step of the workflow, we will operate on each
2D image separately, as opposed to the entire 3D dataset, because we are
interested in a single moment in time for each region.</p>
<p>We apply <code class="xref py py-func docutils literal notranslate"><span class="pre">skimage.measure.label()</span></code> on the binary images so that each
region has its own label. Then, we select the largest region in each image
by computing region properties, including the <code class="docutils literal notranslate"><span class="pre">area</span></code> property, and
sorting by <code class="docutils literal notranslate"><span class="pre">area</span></code> values. Function
<code class="xref py py-func docutils literal notranslate"><span class="pre">skimage.measure.regionprops_table()</span></code> returns a table of region
properties which can be read into a Pandas <code class="docutils literal notranslate"><span class="pre">DataFrame</span></code>.
To begin with, let us consider the first image delta at this stage of the
workflow, <code class="docutils literal notranslate"><span class="pre">binarized[0,</span> <span class="pre">:,</span> <span class="pre">:]</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">labeled_0</span> <span class="o">=</span> <span class="n">measure</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">binarized</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
<span class="n">props_0</span> <span class="o">=</span> <span class="n">measure</span><span class="o">.</span><span class="n">regionprops_table</span><span class="p">(</span>
        <span class="n">labeled_0</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;bbox&#39;</span><span class="p">))</span>
<span class="n">props_0_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props_0</span><span class="p">)</span>
<span class="n">props_0_df</span> <span class="o">=</span> <span class="n">props_0_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># Show top five rows</span>
<span class="n">props_0_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<p>We can thus select the largest region by matching its label with the one
found in the first row of the above (sorted) table. Let us visualize it,
along with its bounding box (bbox) in red.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">largest_region_0</span> <span class="o">=</span> <span class="n">labeled_0</span> <span class="o">==</span> <span class="n">props_0_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">]</span>
<span class="n">minr</span><span class="p">,</span> <span class="n">minc</span><span class="p">,</span> <span class="n">maxr</span><span class="p">,</span> <span class="n">maxc</span> <span class="o">=</span> <span class="p">(</span><span class="n">props_0_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;bbox-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">largest_region_0</span><span class="p">,</span> <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">minc</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">minr</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">maxc</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="n">maxr</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">))</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>We can see how the lower bounds of the box align with the bottom of the
S-L interface by overlaying the same bounding box onto the 0th raw image.
This bounding box was calculated from the image delta between
the 0th and 1st images, but the bottom-most region of the box
corresponds to the location of the interface earlier
in time (0th image) because the interface is moving upward.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_sequence</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_shape</span><span class="p">(</span>
        <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;rect&#39;</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="n">minc</span><span class="p">,</span> <span class="n">y0</span><span class="o">=</span><span class="n">minr</span><span class="p">,</span> <span class="n">x1</span><span class="o">=</span><span class="n">maxc</span><span class="p">,</span> <span class="n">y1</span><span class="o">=</span><span class="n">maxr</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;Red&#39;</span><span class="p">))</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
<p>We are now ready to perform this selection for all image deltas in the
sequence. We shall also store
the bbox information, which will be used to track the
position of the S-L interface.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">largest_region</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.empty_like.html#numpy.empty_like" title="numpy.empty_like" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">empty_like</span></a><span class="p">(</span><span class="n">binarized</span><span class="p">)</span>
<span class="n">bboxes</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">binarized</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">labeled</span> <span class="o">=</span> <span class="n">measure</span><span class="o">.</span><span class="n">label</span><span class="p">(</span><span class="n">binarized</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:])</span>
    <span class="n">props</span> <span class="o">=</span> <span class="n">measure</span><span class="o">.</span><span class="n">regionprops_table</span><span class="p">(</span>
            <span class="n">labeled</span><span class="p">,</span> <span class="n">properties</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="s1">&#39;bbox&#39;</span><span class="p">))</span>
    <span class="n">props_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">props</span><span class="p">)</span>
    <span class="n">props_df</span> <span class="o">=</span> <span class="n">props_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;area&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">largest_region</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">=</span> <span class="p">(</span><span class="n">labeled</span> <span class="o">==</span> <span class="n">props_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
    <span class="n">bboxes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">props_df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="sa">f</span><span class="s1">&#39;bbox-</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)])</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span>
    <span class="n">largest_region</span><span class="p">,</span>
    <span class="n">animation_frame</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
    <span class="n">binary_string</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;animation_frame&#39;</span><span class="p">:</span> <span class="s1">&#39;time point&#39;</span><span class="p">}</span>
<span class="p">)</span>
<span class="n">plotly</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="plot-interface-location-over-time">
<h2>Plot interface location over time<a class="headerlink" href="#plot-interface-location-over-time" title="Permalink to this heading">#</a></h2>
<p>The final step in this analysis is to plot the location of the S-L
interfaces over time. This can be achieved by plotting <code class="docutils literal notranslate"><span class="pre">maxr</span></code>
(third element in bbox)
over time since this value shows the <em class="xref py py-obj">y</em> location of the bottom of
the interface. The pixel size in this experiment was 1.93 microns
and the framerate was 80,000 frames per second, so these values
are used to convert pixels and image number to physical units.
We calculate the average solidfication velocity by fitting a linear
polynomial to the scatter plot. The velocity is the first-order coefficient.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ums_per_pixel</span> <span class="o">=</span> <span class="mf">1.93</span>
<span class="n">fps</span> <span class="o">=</span> <span class="mi">80000</span>
<span class="n">interface_y_um</span> <span class="o">=</span> <span class="p">[</span><span class="n">ums_per_pixel</span> <span class="o">*</span> <span class="n">bbox</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="k">for</span> <span class="n">bbox</span> <span class="ow">in</span> <span class="n">bboxes</span><span class="p">]</span>
<span class="n">time_us</span> <span class="o">=</span> <span class="mf">1e6</span> <span class="o">/</span> <span class="n">fps</span> <span class="o">*</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="numpy.arange" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">arange</span></a><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">interface_y_um</span><span class="p">))</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="n">dpi</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">time_us</span><span class="p">,</span> <span class="n">interface_y_um</span><span class="p">)</span>
<span class="n">c0</span><span class="p">,</span> <span class="n">c1</span> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.polynomial.polynomial.polyfit.html#numpy.polynomial.polynomial.polyfit" title="numpy.polynomial.polynomial.polyfit" class="sphx-glr-backref-module-numpy-polynomial-polynomial sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">polyfit</span></a><span class="p">(</span><span class="n">time_us</span><span class="p">,</span> <span class="n">interface_y_um</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_us</span><span class="p">,</span> <span class="n">c1</span> <span class="o">*</span> <span class="n">time_us</span> <span class="o">+</span> <span class="n">c0</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Velocity: </span><span class="si">{</span><span class="nb">abs</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">c1</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="si">}</span><span class="s1"> m/s&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;S-L interface location vs. time&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Location ($\mu$m)&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Time ($\mu$s)&#39;</span><span class="p">)</span>
<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-applications-plot-solidification-tracking-py">
<div class="binder-badge docutils container">
<a class="reference external image-reference" href="https://mybinder.org/v2/gh/scikit-image/scikit-image/main?filepath=notebooks/auto_examples/applications/plot_solidification_tracking.ipynb"><img alt="Launch binder" src="../../_images/binder_badge_logo.svg" width="150px" /></a>
</div>
<div class="lite-badge docutils container">
<a class="reference external image-reference" href="../../lite/lab/?path=auto_examples/applications/plot_solidification_tracking.ipynb"><img alt="Launch JupyterLite" src="../../_images/jupyterlite_badge_logo.svg" width="150px" /></a>
</div>
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/25c6a3ccec65e3ef16f2fa199c8c2189/plot_solidification_tracking.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_solidification_tracking.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/439b9ec9b60a3ab14ffe0a091b63611c/plot_solidification_tracking.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_solidification_tracking.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="plot_thresholding_guide.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Thresholding</p>
      </div>
    </a>
    <a class="right-next"
       href="plot_fluorescence_nuclear_envelope.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Measure fluorescence intensity at the nuclear envelope</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#compute-image-deltas">Compute image deltas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clip-lowest-and-highest-intensities">Clip lowest and highest intensities</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invert-and-denoise">Invert and denoise</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#binarize">Binarize</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-largest-region">Select largest region</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#plot-interface-location-over-time">Plot interface location over time</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/auto_examples/applications/plot_solidification_tracking.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2013, the scikit-image team.
      <br/>
    
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 6.1.3.
    <br/>
  </p>
</div>
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>